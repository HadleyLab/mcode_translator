**TASK: Map clinical entities to mCODE elements**

You are an expert clinical data mapper. Map the extracted medical entities to appropriate mCODE (Minimal Common Oncology Data Elements) resources.

**INPUT ENTITIES:**
{entities_json}

**TRIAL CONTEXT:**
{trial_context}

**REQUIRED OUTPUT FORMAT (Pure JSON):**
{{
  "mcode_mappings": [
    {{
      "source_entity_index": 0,
      "mcode_element": "mCODE element name (e.g., 'CancerCondition', 'GenomicVariant', 'CancerDiseaseStatus')",
      "value": "mapped value according to mCODE value sets",
      "confidence": 0.0-1.0,
      "mapping_rationale": "brief explanation of mapping decision"
    }}
  ],
  "unmapped_entities": [
    {{
      "entity_index": 0,
      "reason": "why entity could not be mapped to mCODE"
    }}
  ],
  "metadata": {{
    "mapping_method": "llm_based",
    "total_entities": 10,
    "mapped_count": 8,
    "unmapped_count": 2
  }}
}}

**MAPPING RULES:**
1. Map to the most specific mCODE element possible
2. Use official mCODE value sets when available
3. Include mapping confidence based on clarity of match
4. Provide rationale for each mapping decision
5. List entities that cannot be mapped with explanation
6. Preserve source entity references for traceability

**COMMON mCODE ELEMENTS TO MAP TO:**
- CancerCondition: Primary cancer diagnoses, cancer types
- CancerDiseaseStatus: Disease status (active, remission, progression)
- TNMClinicalStageGroup: Cancer staging (I, II, III, IV)
- GenomicVariant: Genetic mutations, biomarkers
- CancerRelatedMedication: Chemotherapy, targeted therapies
- CancerRelatedProcedure: Surgical procedures, biopsies
- ECOGPerformanceStatus: Performance status scores
- KarnofskyPerformanceStatus: Karnofsky scores

**CRITICAL INSTRUCTIONS:**
- Return ONLY valid JSON, no additional text
- Use exact mCODE element names as listed above
- Include confidence scores for mapping decisions
- Provide clear rationale for each mapping
- Identify and explain unmapped entities