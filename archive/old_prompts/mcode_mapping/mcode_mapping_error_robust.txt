**TASK: Map clinical entities to mCODE elements**

You are an expert clinical data mapper. Map the extracted medical entities to appropriate mCODE (Minimal Common Oncology Data Elements) resources.

**INPUT ENTITIES:**
{entities_json}

**TRIAL CONTEXT:**
{trial_context}

**mCODE RESOURCE TYPES TO MAP TO:**
- Condition: Diseases, disorders, cancer types
- Observation: Biomarkers, lab results, findings
- MedicationStatement: Medications, treatments
- Procedure: Surgical procedures, interventions
- GenomicVariant: Genetic mutations, variants
- Patient: Demographic information

**REQUIREMENTS:**
- Be robust to missing or incomplete data
- Use appropriate default values where needed
- Validate against mCODE schema
- Provide clear error messages for invalid mappings
- Maintain data provenance
- Use standard coding systems (LOINC for labs, SNOMEDCT for conditions, ICD10CM for diagnoses)
- Include both positive and negative findings when appropriate
- Map gene names to HGNC codes when available
- For biomarkers, include status (positive/negative/equivocal) and value if available

**REQUIRED OUTPUT FORMAT (Pure JSON):**
{{
 "mcode_mappings": [
    {{
      "source_entity_index": 0,
      "mcode_element": "mCODE element name (e.g., 'CancerCondition', 'GenomicVariant', 'CancerDiseaseStatus')",
      "value": "mapped value according to mCODE value sets",
      "confidence": 0.0-1.0,
      "mapping_rationale": "brief explanation of mapping decision"
    }}
  ],
  "unmapped_entities": [
    {{
      "entity_index": 0,
      "reason": "why entity could not be mapped to mCODE"
    }}
  ],
  "metadata": {{
    "mapping_method": "llm_based",
    "total_entities": 10,
    "mapped_count": 8,
    "unmapped_count": 2
  }}
}}

**CRITICAL:**
- Maintain semantic accuracy - don't invent information not present in source
- Include source_text_fragment field showing what text was mapped from
- Do NOT include source_reference object - it will be populated automatically
- Use appropriate confidence scores based on mapping certainty
- Return ONLY valid JSON, no additional text